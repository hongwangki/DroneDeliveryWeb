<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>배달의 드론 | 가게 목록</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">

    <style>
        :root{
            --mint:#2AC1BC; --mint-d:#21a7a2;
            --ink:#0f172a; --muted:#64748b;
            --bg:#f6f7fb; --card:#ffffff; --chip:#eef6f6; --border:#e5e7eb;
            --shadow:0 10px 24px rgba(15,23,42,.08), 0 2px 6px rgba(15,23,42,.06);
            --radius:18px; --radius-lg:22px; --gap:18px;
        }
        *{box-sizing:border-box}
        html,body{height:100%}
        body{
            margin:0; font-family:'Noto Sans KR',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; color:var(--ink);
            background:
                    radial-gradient(circle at 0 0, rgba(15,23,42,.06) 0, rgba(15,23,42,.06) 1px, transparent 1px),
                    linear-gradient(180deg, #fafbff 0%, var(--bg) 100%);
            background-size:18px 18px, auto; background-attachment:fixed;
        }

        /* header */
        .appbar{ position:sticky; top:0; z-index:50; backdrop-filter:blur(6px); background:rgba(255,255,255,.85); border-bottom:1px solid var(--border); }
        .appbar-inner{ max-width:1200px; margin:0 auto; padding:12px 20px; display:flex; align-items:center; justify-content:space-between; }
        .brand{ display:flex; align-items:center; gap:10px; font-weight:900; color:#0b3d3b; }
        .logo{ width:32px; height:32px; display:grid; place-items:center; background:var(--mint); color:#fff; border-radius:10px; font-weight:900; box-shadow:0 6px 14px rgba(42,193,188,.25); }
        .nav a{ text-decoration:none; color:var(--muted); margin-left:16px; font-weight:600; }
        .nav a:hover{ color:#0b3d3b }

        /* frame */
        .wrap{ max-width:1200px; margin:26px auto 80px; padding:0 20px; }
        .page-head{ background:linear-gradient(180deg,#e9fbfa,#f7fffe); border:1px solid #dbf5f2; padding:22px; border-radius:var(--radius-lg); box-shadow:var(--shadow); }
        .page-head h1{ margin:0 0 6px; font-size:32px; letter-spacing:-.3px }
        .page-head p{ margin:0; color:var(--muted) }

        .realtime{ margin:18px 0; display:inline-flex; align-items:center; gap:10px; background:#e6fffb; color:#065f5b; font-weight:800; border:1px solid #c9f4ef; padding:10px 14px; border-radius:12px; text-decoration:none; box-shadow:0 6px 14px rgba(6,95,91,.08); }
        .realtime:hover{ background:#dff7f3 }

        /* tabs */
        .cats{ display:flex; gap:10px; overflow:auto; padding:6px 2px 8px; scrollbar-width:none }
        .cats::-webkit-scrollbar{ display:none }
        .cat{ flex:0 0 auto; text-decoration:none; color:#0b3d3b; font-weight:700; background:#eef7f7; border:1px solid #e4f0f0; padding:10px 14px; border-radius:999px; transition:.15s }
        .cat:hover{ background:#e3f2f2 }
        .cat.active{ background:var(--mint); color:#fff; border-color:var(--mint); box-shadow:0 6px 14px rgba(42,193,188,.28) }

        /* grid */
        .grid{ display:grid; gap:var(--gap); grid-template-columns:repeat(3,minmax(0,1fr)); margin-top:14px }
        @media (max-width:1100px){ .grid{ grid-template-columns:repeat(2,1fr) } }
        @media (max-width:640px){ .grid{ grid-template-columns:1fr } }

        /* card */
        .card{ background:var(--card); border:1px solid var(--border); border-radius:var(--radius-lg); box-shadow:var(--shadow); padding:16px; text-decoration:none; color:inherit; transition:transform .18s, box-shadow .18s, border-color .18s; display:block }
        .card:hover{ transform:translateY(-2px); box-shadow:0 14px 30px rgba(15,23,42,.10),0 4px 10px rgba(15,23,42,.06); border-color:#dfe3ea }

        .card-row{ display:flex; gap:14px }
        .thumb{
            width:92px; height:92px; border-radius:12px; flex-shrink:0; object-fit:cover; background:#f3f4f6;
            border:1px solid #eef1f4;
        }
        .thumb.placeholder{
            background:linear-gradient(135deg, #def7f5, #f4fffe);
            border:1px solid #d4f0ed;
        }
        .content{ flex:1; min-width:0 }

        .card-head{ display:flex; align-items:center; justify-content:space-between }
        .name{ font-weight:900; font-size:18px; letter-spacing:-.2px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap }
        .badge{ background:#eef6f6; color:#0b3d3b; font-weight:800; font-size:12px; padding:6px 10px; border-radius:999px; border:1px solid #dceeee }
        .meta{ margin-top:6px; color:var(--muted); font-size:14px; display:flex; gap:12px; flex-wrap:wrap }
        .chip{ background:#f5fbfb; border:1px solid #e2f3f1; color:#0b3d3b; font-weight:800; padding:4px 8px; border-radius:999px; font-size:12px }
        .desc{ margin-top:8px; color:#3b475a; font-size:14px; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden }

        .cta{ margin-top:12px; display:flex; justify-content:space-between; align-items:center; opacity:.9; }
        .card:hover .cta{ opacity:1 }
        .go{ background:var(--mint); color:#fff; border:none; padding:10px 12px; border-radius:12px; font-weight:800; cursor:pointer; text-decoration:none; display:inline-flex; align-items:center; gap:8px; box-shadow:0 10px 18px rgba(42,193,188,.22) }
        .go:hover{ background:var(--mint-d) }
    </style>
</head>
<body>

<header class="appbar">
    <div class="appbar-inner">
        <div class="brand"><span class="logo">드</span>배달의 드론</div>
        <nav class="nav">
            <a th:href="@{/reviews}">나의리뷰</a>
            <a th:href="@{/orders}">주문내역</a>
            <a th:href="@{/account}">정보보기</a>
            <a th:href="@{/recharge}">돈충전</a>
            <a th:href="@{/settings}">설정</a>
            <a th:href="@{/logout}">로그아웃</a>
        </nav>
    </div>
</header>

<main class="wrap">
    <section class="page-head">
        <h1>가게 목록</h1>
        <p>가볍게 고르고, 드론으로 빠르게 받아보세요.</p>
    </section>

    <a class="realtime" th:href="@{/realtime}">📦 실시간 주문 현황 보기</a>

    <div class="cats" aria-label="카테고리">
        <a class="cat" th:classappend="${selectedCategory == '전체'} ? ' active'" th:href="@{/delivery(category='전체')}">전체</a>
        <a class="cat" th:classappend="${selectedCategory == '치킨'} ? ' active'" th:href="@{/delivery(category='치킨')}">치킨</a>
        <a class="cat" th:classappend="${selectedCategory == '한식'} ? ' active'" th:href="@{/delivery(category='한식')}">한식</a>
        <a class="cat" th:classappend="${selectedCategory == '중식'} ? ' active'" th:href="@{/delivery(category='중식')}">중식</a>
        <a class="cat" th:classappend="${selectedCategory == '피자'} ? ' active'" th:href="@{/delivery(category='피자')}">피자</a>
        <a class="cat" th:classappend="${selectedCategory == '족발'} ? ' active'" th:href="@{/delivery(category='족발')}">족발</a>
        <a class="cat" th:classappend="${selectedCategory == '카페'} ? ' active'" th:href="@{/delivery(category='카페')}">카페</a>
        <a class="cat" th:classappend="${selectedCategory == '햄버거'} ? ' active'" th:href="@{/delivery(category='햄버거')}">햄버거</a>
        <a class="cat" th:classappend="${selectedCategory == '분식'} ? ' active'" th:href="@{/delivery(category='분식')}">분식</a>
        <a class="cat" th:classappend="${selectedCategory == '일식'} ? ' active'" th:href="@{/delivery(category='일식')}">일식</a>
        <a class="cat" th:classappend="${selectedCategory == '디저트'} ? ' active'" th:href="@{/delivery(category='디저트')}">디저트</a>
    </div>

    <!-- Store grid -->
    <section class="grid">
        <a th:each="store : ${stores}"
           th:href="@{'/delivery/' + ${store.id}}"
           class="card" aria-label="가게 카드">

            <div class="card-row">
                <!-- 썸네일: 이미지 있으면 img, 없으면 placeholder -->
                <img class="thumb"
                     loading="lazy"
                     th:if="${!#strings.isEmpty(store.imageUrl)}"
                     th:src="${store.imageUrl}"
                     alt="가게 이미지"
                     onerror="this.replaceWith(Object.assign(document.createElement('div'),{className:'thumb placeholder',ariaHidden:'true'}));">
                <div class="thumb placeholder" th:if="${#strings.isEmpty(store.imageUrl)}" aria-hidden="true"></div>

                <div class="content">
                    <div class="card-head">
                        <div class="name" th:text="${store.name}">가게 이름</div>
                        <span class="badge" th:text="${store.category}">카테고리</span>
                    </div>

                    <div class="meta">
            <span class="chip"
                  th:if="${store.minOrderPrice != null}"
                  th:text="'최소주문 ' + ${#numbers.formatInteger(store.minOrderPrice,0,'COMMA')} + '원'">최소주문 0원</span>
                        <span class="chip"
                              th:if="${store.products != null}"
                              th:text="'메뉴 ' + ${#lists.size(store.products)} + '개'">메뉴 0개</span>
                    </div>

                    <p class="desc" th:text="${store.description}">가게 설명</p>

                    <div class="cta">
                        <span style="color:var(--muted); font-weight:700;">바로 주문하기</span>
                        <span class="go" aria-hidden="true">가게 보기 →</span>
                    </div>
                </div>
            </div>
        </a>
    </section>
</main>

</body>
</html>
